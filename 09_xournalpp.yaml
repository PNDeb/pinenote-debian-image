{{- $architecture := or .architecture "arm64" -}}
{{- $prevtargz := or .prevtargz "08_greeter.tar.gz" }}
{{- $targz := or .targz "09_xournalpp.tar.gz" }}

architecture: {{ $architecture }}

actions:
  - action: unpack
    file: {{ $prevtargz }}

  - action: apt
    recommends: false
    description: Install xournalpp so we get all dependencies
    packages:
      - xournalpp

  - action: run
    description: Install our custom Xournalpp deb
    chroot: true
    command: dpkg -i /root/custom_debs/xournalpp*.deb

  - action: run
    description: Install Xournalpp default configuration
    chroot: true
    command: dpkg -i /root/custom_debs/pn-defaut-xpp-config_*.deb

  - action: pack
    file: {{ $targz }}
